<div class="container">
  <div class="row justify-content-center">
    <div class="col-md-6">
      <div class="card">
        <div class="card-body text-center"> 
          <h4 class="card-title">Monthly Report</h4>
          <label for="month">Select Month:</label>
          <div class="text-center mt-2">
            <div class="form-control d-inline-flex align-items-center justify-content-center">
              <input type="month" [(ngModel)]="selectedDate" (ngModelChange)="getTasksForSelectedMonth()" placeholder="Select a date (Month and Year)">
            </div>
            <div *ngIf="selectedDate" class="selected-date">{{ selectedDate | date: 'MMMM yyyy' }}</div>
          </div>
          <div class="mt-3"> 
            <button pButton pRipple label="Export Excel" (click)="exportMonthlyReport()" [disabled]="!selectedDate"></button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<div class="col-12 mt-4">
  <div class="card">
    <h4>Information for the selected month</h4>
    <p-table
      [value]="selectedMonthTasks"
      responsiveLayout="scroll"
      [scrollable]="true"
      scrollHeight="400px"
    >
      <ng-template pTemplate="header">
        <tr>
          <th>Creation Date</th>
          <th>Task</th>
          <th>Description</th>
          <th>Time Spent</th>
          <th>Project Name</th>
          <th>Employee</th>
        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-task>
        <tr>
          <td>{{ task.currentDate | date: 'yyyy-MM-dd' }}</td>
          <td>{{ task.title }}</td>
          <td>{{ task.description }}</td>
          <td>{{ task.workHours }}</td>
          <td>{{ task.projectName }}</td>
          <td>{{task.userName}}</td>
        </tr>
      </ng-template>
    </p-table>
  </div>
</div>
